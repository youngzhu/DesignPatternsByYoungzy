# [译文]空对象模式

> 原文网址：[Null Object Design Pattern](https://sourcemaking.com/design_patterns/null_object)

## 意图
空对象模式的意图是为一个不存在的对象提供一个可替换的选择，该替换对象不做任何实际操作。简而言之，就是一个“无中生有”的模式。

以下场景可以使用空对象模式：

- 一个需要合作者的对象。空对象模式不引人新的合作关系，它使用已存在的关系
- 有些合作对象的实例不需要做任何事
- 你想抽象的处理 `Null`，使其远离客户端

## 问题
一个对象的引用可能为 null，所以需要一个对null的校验（没有任何实际业务操作）或者使用一些默认值。
如何使一个不存在的对象——空引用——可以被透明处理？

## 讨论
有时候，一个类需要一个合作者，而不需要这个合作者做任何事。
而这个类希望将无作为的合作者和有作为的合作者同等对待。

以屏保程序为例，它会在屏幕上显示一些四处滚动的、不同颜色的球。
这很容易实现，创建一个类 Ball 代表球，使用一个策略模式来控制球的运动，另一个策略模式来控制球的颜色。

接下来就是要写各种不同动作和颜色的策略，并用这些组合去创建球。
但是，在开始前，你需要创建一个最简单的策略，以确保一切都能正常。
所有策略都会有用的，因为你需要尽可能多的策略。

![](https://sourcemaking.com/files/v2/content/patterns/Null_Object1.png)

而最简单的策略就是没有策略，什么都不做，既不移动，也不改变颜色。
但是策略模式要求球必须含有实现了策略接口的对象。这就让空对象模式有了用武之地。

简单地实现一个类 `NullMovementStrategy`，它不会移动球；和一个 `NullColorStrategy` 类，它不会改变球的颜色。
它们可能都不需要有什么实质上的代码。所有的方法都是什么都不用做。这是空对象模式的完美例子。

空对象模式的关键是为这一类的对象创建一个抽象的类。空对象是这个抽象类的子类。
因为它遵循了这个抽象类的接口定义，所以它可以被用在任何使用这类对象的地方。
作为对比，一个特殊的“空”值——没有实现这个抽象类——经常需要一下额外的代码来做校验。

尽管，有时候空对象显得过于简单和愚蠢了，但实际上它知道自己该做什么，且不跟其他对象发生交互。
所以，事实上，它是很聪明的。

## 结构

![](https://sourcemaking.com/files/v2/content/patterns/Null_Object2.png)

- 客户端：需要合作者
- 抽象对象
    - 定义客户端需要合作的接口
    - 适当地提供一些通用的接口实现
- 真实对象：定义一个具体的抽象对象的子类，它提供了客户端想要的某些行为
- 空对象
    - 也是抽象对象的子类，所以可以作为真实对象的替身
    - 实现的接口不需要做任何事。这里说的“不做任何事”也要看客户端具体需要哪种行为
    - 如果有多种“不作为”的方式，那就需要多个空对象

## 经验法则
1. 空对象通常是单例模式。因为一个空对象通常没有状态。即使有，它也不会改变，所以多个实例是完全一样的。
用多个一模一样的实例，还不如重复地使用单个实例。
2. 如果某些客户端希望空对象这样做，而另一些希望那样做，那么就需要多个“空对象”类。如果“无作为”需要在运行时被定制化，
那么空对象类就需要提供参数以便客户端指定何种的“无作为”（见适配器模式）。没有一个规范的定义，是“抽象类”的症结所在。
3. 空对象不是实际对象的过渡。如果一个对象决定不再“无作为”而是提供实际的功能，它就不再是空对象。它可能是一个无作为模式下的实际对象，
例如在只读模式下控制读和写的控制器。如果一个对象必须从一个无作为的对象变成一个实际的对象，它可以使用状态模式或者代理模式。
这样，就可能使用“空状态”，或者一个含有空对象的代理。
4. 空对象模式和代理模式很像，但它们的目的不同。代理，是在访问真实对象的时候提供了一个间接层，进而控制了对象的访问。
空对象没有隐藏真实对象，也没有控制对它的访问，而是替代了实际对象。代理，最终会像真实对象一样提供服务。而空对象不会有真正的作为，
它一直是“无作为”。
5. 空对象模式可以看作是策略模式的一个特例。策略模式定义了很多具体的策略，每一个策略代表了完成这个任务的不同的方法。
如果有一个策略就是不作为，那这个策略就是一个空对象。例如，在一组视图策略中，`Controller` 是用来处理输入，那么
`NoController` 就是用来忽略所有输入的。
6. 空对象模式也可以看作是状态模式的一个特例。一般来讲，具体的某个状态会有一些不作为的方法，因为这些方法对当前状态不适用。
事实上，对于某个特定的方法，在多数状态里都会做一些有意义的事，但至少有一个状态是不能有作为的。如果某个状态实现了大多数的
无作为的方法或者不产生任何结果，它就变成了一个“无作为”的状态，也就是一个空状态。
7. 空对象模式的使用可以让访问者安全地访问一个层次结构并处理空情形。
8. 空对象是客户端需要的一个具体的合作者。空对象不是为了一个需要部分无作为方法的对象而设计的，而是为无作为或有作为的对象而设计的。


