# [译文]备忘录模式

> 原文网址：[Memento Design Pattern](https://sourcemaking.com/design_patterns/memento)

## 意图
- 在不违反封装性的前提下，捕获并具象化一个对象的内部状态，以便这个对象之后可以再恢复到这个状态。
- 一个检查站的功能
- 促使撤销变成一个完全的对象状态

## 问题
需要将一个对象恢复到之前的某个状态，如撤销、回滚操作。

## 讨论
当需要存储某个对象状态时，客户端就从源对象请求获取一个“备忘录”。
源对象用它状态的特性描述来初始化一个备忘录。
客户端是备忘录的守护者，只有源对象可以从备忘录存储或获取信息。备忘录对于客户端和其他所有对象都是不透明的。
如果客户随后需要回滚这个源对象的状态，它就将这个备忘录传递给源对象以便恢复。

无限次的撤销可以很轻松地由“命令对象”的栈和“备忘录对象”的栈来实现。

备忘录模式定义了三类明显的角色：
1. 源对象：知道如何存储自己的状态
2. 守护者：知道为什么、什么时候源对象需要存储和恢复
3. 备忘录：一个由源对象读写的盒子，由守护者看管

## 结构
![](https://sourcemaking.com/files/v2/content/patterns/Memento.png)


## 举例
这种模式在自己维修车子的点式刹车时很常见。
将鼓从两边移除，暴露出左右两边的刹车片。
只拆除一侧的。另一侧作为备忘录提醒着两边是如何组合的。只有这一部分完成后，才拆除另一侧的。
当拆除这一侧时，之前已完成的一侧又成了它的备忘录。

![](https://sourcemaking.com/files/v2/content/patterns/Memento_example.png)

## 核查清单（也可以理解为应用步骤）
1. 明确“源对象”和“守护者”角色
2. 创建一个备忘录对象，并使其和源对象发生关联
3. 守护者知道什么时候要保持源对象状态
4. 源对象创建备忘录对象，并将其状态保存至备忘录中
5. 守护者守护但不可窥探备忘录
6. 守护者知道何时回滚源对象
7. 源对象通过存储在备忘录中的状态恢复自己

