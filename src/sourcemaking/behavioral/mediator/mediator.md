# [译文]中介模式

> 原文网址：[Mediator Design Pattern](https://sourcemaking.com/design_patterns/mediator)

## 意图
- 定义一个对象来封装一组对象之间的交互。中介可以促进对象之间的松耦合，并且可以独立的改变它们之间的交互。
- 设计一个中介使得很多对象之间解耦
- 将多对多对象之间的交互提升为“全对象状态”

## 问题
想要设计可重用的组件，但潜在的可重用的组件之间的依赖关系就像是“意大利面条”，你想抽出一根面条，结果发现是“全有或全无”。

## 讨论
在Unix系统中，系统资源的访问权限被设定为三个级别：管理员、组和拥有者。
组是一个用户的集合，为了将一些功能模块化。每个系统用户可以是一个或多个组中的一员，
每个组可以有0个或多个用户。下图展示了3个用户被分配到3个组中。

![](https://sourcemaking.com/files/v2/content/patterns/Mediator.png)

假设我们在软件中给它建模，用户（User）和组（Group）是耦合的，组和用户也是耦合的。
当发生改变时，所有的类和实例都会受到影响。

另一种方法是引入一个中介，它映射了用户-组和组-用户的关系，并且它本身是抽象的。
这有很多好处：用户和组之间解耦；多个映射关系可以轻松地同步维护和使用；抽象的映射关系可以在未来通过衍生类来扩展。

![](https://sourcemaking.com/files/v2/content/patterns/Mediator_1.png)

将系统拆分成多个部分一般来说可以提供可重用性，但新增的不同部分之间的交互又会降低可重用性。
中介对象：封装了所有的交互；扮演了交互的中枢；负责控制和协调对象之间的交互；促进了对象之间的松耦合。

中介模式将多对多的关系网络变成了一个对象属性。使用一个对象给内在关系建模增强了封装性，
并且使得内在关系的行为可以通过子类来修改或扩展。

操作系统中用户和用户组的设计就是中介模式的一个例子。一个组可以有0个或多个用户，一个用户可以是0个或多个组的组员。
中介模式提供了一个灵活、非侵入性的方式来连接和管理用户及用户组。

## 结构

![](https://sourcemaking.com/files/v2/content/patterns/Mediator__1.png)

同事之间不是强联系的。每个人都跟中介对话，通过中介来了解或管理其他人。
同事之间原本存在的多对多的关系，现在已升级为“完整对象状态”。
这种新的抽象提供一个间接的关系，起到了一定的杠杆作用。

![](https://sourcemaking.com/files/v2/content/patterns/Mediator___1.png)


## 举例
各关联对象之间通过中介沟通，而不是彼此沟通的方式实现了对象之间的松耦合。机场的控制塔很好地演示了这种模式。
在进入或离开机场时，飞机的驾驶员是跟机场的塔台沟通，而不是飞行员之间沟通。谁起飞谁降落是由塔台决定的。
需要注意的是，塔台并不控制整个航程。它只在机场内实施这些控制。

![](https://sourcemaking.com/files/v2/content/patterns/Mediator_example.png)

## 核查清单（也可以理解为应用步骤）
1. 识别出一组彼此之间有交互的、可以从解耦获益的对象
2. 将这些交互封装到一个新的抽象类中
3. 创建一个新类的实例，即中介，然后使所有的交互对象只跟中介交互
4. 平衡解耦原则和责任均分原则
5. 注意，不要创建“独裁者”或“上帝”对象

